from flask import Flask, render_template
import requests

app = Flask(__name__)

@app.route('/')
def home():
    url = "https://cricbuzz-cricket.p.rapidapi.com/matches/v1/recent"
    headers = {
        "X-RapidAPI-Host": "cricbuzz-cricket.p.rapidapi.com",
        "X-RapidAPI-Key": "327a4f3817msh0e716c198181c52p17c0ffjsn0e7e53feb9b3"
    }

    response = requests.get(url, headers=headers)
    data = response.json()

    cricket_scores = []
    upcoming_matches = []

    for match in data.get('matches', []):
        state = match.get('matchInfo', {}).get('state')
        team1 = match.get('team1', {}).get('name', 'Team 1')
        team2 = match.get('team2', {}).get('name', 'Team 2')
        status = match.get('status', 'N/A')
        date = match.get('matchInfo', {}).get('startDate', 'N/A')

        if state == "Complete":
            # Format into HTML for rendering
            score_html = f"<strong>{team1} vs {team2}</strong><br>Status: {status}"
            cricket_scores.append(score_html)

        elif state == "Preview":
            upcoming_match = {
                "Date": date,
                "Description": status,
                "Teams": f"{team1} vs {team2}"
            }
            upcoming_matches.append(upcoming_match)

    return render_template('index.html', cricket_scores=cricket_scores, upcoming_matches=upcoming_matches)

if __name__ == '__main__':
    app.run(debug=True)
